#Include "Totvs.ch"
#INCLUDE "FWMVCDEF.CH"

//-------------------------------------------------------------------
/*/{Protheus.doc} CRMA980_PE
Fonte Para Automatizar o processo de cadastro de clientes
com seus contatos
@author Thiago Alves
@since 29/09/2024

	######## ##     ## ####    ###     ######    #######
		##    ##     ##  ##    ## ##   ##    ##  ##     ##
		##    ##     ##  ##   ##   ##  ##        ##     ##
		##    #########  ##  ##     ## ##   #### ##     ##
		##    ##     ##  ##  ######### ##    ##  ##     ##
		##    ##     ##  ##  ##     ## ##    ##  ##     ##
		##    ##     ## #### ##     ##  ######    #######

/*/
//-------------------------------------------------------------------

User Function CRMA980_PE()

	Local aArea := GetArea()
	Local oBrowse
	oBrowse:= FwmBrowse():New()
	oBrowse:SetAlias("SA1")
	oBrowse:SetDescription("Cadastro de Cientes")
	oBrowse:Activate()
	RestArea(aArea)

return

Static Function ModelDef()

	Local cCpoAC8Cab	:= "AC8_FILIAL|AC8_FILENT|AC8_ENTIDA|AC8_CODENT|"
	Local bAvCpoCab		:= {|cCampo| AllTrim(cCampo)+"|" $ cCpoAC8Cab}
	Local oStructMST 	:= FWFormStruct(1,"AC8",bAvCpoCab)
	Local oStructAC8 	:= FWFormStruct(1,"AC8")
	Local oModel 		:= FWLoadModel("CRMA980")


	oStructMST:AddField(	AllTrim("STR0003")				,; 	// [01] C Titulo do campo
							AllTrim("STR0004")				,; 	// [02] C ToolTip do campo //"Tipo de Entidade"
							"AC8_ENTNOM" 					,; 	// [03] C identificador (ID) do Field
							"C" 							,; 	// [04] C Tipo do campo
							30 								,; 	// [05] N Tamanho do campo
							0 								,; 	// [06] N Decimal do campo
							Nil 							,; 	// [07] B Code-block de validação do campo
							Nil								,; 	// [08] B Code-block de validação When do campo
							Nil					 			,; 	// [09] A Lista de valores permitido do campo
							Nil 							,; 	// [10] L Indica se o campo tem preenchimento obrigatório
							Nil		 			   			,;  // [11] B Code-block de inicializacao do campo
							Nil 							,; 	// [12] L Indica se trata de um campo chave
							Nil				 				,; 	// [13] L Indica se o campo pode receber valor em uma operação de update.
							Nil )

	oStructAC8:SetProperty("AC8_FILENT",MODEL_FIELD_INIT,FwBuildFeature(STRUCT_FEATURE_INIPAD, "CRMA060IFil()" ))


	oModel:AddFields("AC8MASTER","SA1MASTER",oStructMST,/*bPreValidacao*/,/*bPosValidacao*/,/*bCarga*/)
	oModel:AddGrid("AC8CONTDET","SA1MASTER",oStructAC8,/*bPreValidacao*/,/*bPosValidacao*/,/*bCarga*/)


	
	oModel:GetModel("AC8CONTDET"):SetOptional( .T. )

	oModel:GetModel("AC8CONTDET"):SetUniqueLine({"AC8_CODCON"})

	oModel:GetModel("AC8CONTDET"):SetMaxLine(9999)

	oModel:SetRelation("AC8CONTDET",{ {"AC8_FILIAL","AC8_FILIAL"},;
		{"AC8_FILENT","AC8_FILENT"},;
		{"AC8_ENTIDA","AC8_ENTIDA"},;
		{"AC8_CODENT","AC8_CODENT"};
		},AC8->( IndexKey(1)))

	oModel:SetRelation("AC8MASTER",{{"AC8_FILIAL", "AC8_FILIAL"},;
		{"AC8_FILENT", "xFilial('SA1')"},;
		{"AC8_ENTIDA","'SA1'"},;
		{"AC8_CODENT","A1_COD+A1_LOJA"};
		},AC8->( IndexKey( 1 ) ))

Return oModel



Static Function ViewDef()

	Local oView		    := Nil
	Local oModel		:= ModelDef()
	Local oStructSA1	:= FWFormStruct(2,"SA1",/*bAvalCampo*/,/*lViewUsado*/)
	Local oStructAI0	:= FWFormStruct(2,"AI0",/*bAvalCampo*/,/*lViewUsado*/)
	Local cCpoAC8Cab	:= "AC8_FILIAL|AC8_FILENT|AC8_ENTIDA|AC8_CODENT|"
	Local bAvCpoCab		:= {|cCampo| AllTrim(cCampo)+"|" $ cCpoAC8Cab}
	Local oStructMST 	:= FWFormStruct(2,"AC8",bAvCpoCab)
	Local oStructAC8 	:= FWFormStruct(2,"AC8")

	oView:= FWFormView():New()
	oView:SetModel(oModel)


	oStructMST:SetProperty("AC8_CODENT",MVC_VIEW_CANCHANGE,.F.)
	
	oStructMST:SetProperty("AC8_ENTIDA" , MVC_VIEW_CANCHANGE, .F. )
	oStructMST:AddField(	"AC8_ENTNOM" 			,;	// [01] C Nome do Campo
							"05" 					,; 	// [02] C Ordem
							"Entidade"				,; 	// [03] C Titulo do campo//"Entidade"
							"Tipo de Entidade"		,; 	// [04] C Descrição do campo//"Tipo de Entidade"
							{} 	   					,; 	// [05] A Array com Help
							"C" 					,; 	// [06] C Tipo do campo
							"@!" 					,; 	// [07] C Picture
							Nil 					,; 	// [08] B Bloco de Picture Var
							Nil 					,; 	// [09] C Consulta F3
							.F. 					,;	// [10] L Indica se o campo é evitável
							Nil 					,; 	// [11] C Pasta do campo
							Nil 					,;	// [12] C Agrupamento do campo
							Nil 					,; 	// [13] A Lista de valores permitido do campo (Combo)
							Nil 					,;	// [14] N Tamanho Maximo da maior opção do combo
							Nil 					,;	// [15] C Inicializador de Browse
							Nil 					,;	// [16] L Indica se o campo é virtual
							Nil 					,;
							Nil						,;
							Nil						,;
							Nil						,;
							Nil)


	oStructMST:RemoveField("AC8_FILENT")
	oStructAC8:RemoveField("AC8_FILIAL")
	oStructAC8:RemoveField("AC8_FILENT")
	oStructAC8:RemoveField("AC8_ENTIDA")
	oStructAC8:RemoveField("AC8_CODENT")



	oView:CreateHorizontalBox("BOXFORMALL",100)
	oView:CreateFolder("FOLDER","BOXFORMALL")
	oView:AddSheet("FOLDER","SHEETSA1","Principal")
	oView:AddSheet("FOLDER","SHEETAI0","Informações Complementares")
	oView:AddSheet("FOLDER","SHEETCTO","Contatos")

	oView:CreateHorizontalBox("BOXFORMSA1",100,/*cIdOwner*/,/*lFixPixel*/,"FOLDER","SHEETSA1")
	oView:CreateHorizontalBox("BOXFORMAI0",100,/*cIdOwner*/,/*lFixPixel*/,"FOLDER","SHEETAI0")
	oView:CreateHorizontalBox("VIEW_TOP",20,/*cIdOwner*/,/*lFixPixel*/,"FOLDER","SHEETCTO")
	oView:CreateHorizontalBox("VIEW_DET",80,/*cIdOwner*/,/*lFixPixel*/,"FOLDER","SHEETCTO")


	oView:AddField("VIEW_SA1",oStructSA1,"SA1MASTER")
	oView:SetOwnerView("VIEW_SA1","BOXFORMSA1")

	oView:AddField("VIEW_AI0",oStructAI0,"AI0CHILD")
	oView:SetOwnerView("VIEW_AI0","BOXFORMAI0")

	oView:AddField("VIEW_MST",oStructMST,"AC8MASTER")
	oView:SetOwnerView("VIEW_MST","VIEW_TOP")

	oView:AddGrid("VIEW_AC8",oStructAC8, "AC8CONTDET")
	oView:SetOwnerView("VIEW_AC8","VIEW_DET")



Return oView


Static Function MenuDef()
	local aRotina     := FWMVCMenu("CRMA980_PE")


Return aRotina




UPDATE SX3
SET 
    U5_FILIAL = '01',
    U5_CODCONT = '123456',
    U5_CPF = '12345678901234',
    U5_END = 'Rua Exemplo, 123',
    U5_RG = 'MG1234567',
    U5_BAIRRO = 'Centro',
    U5_MUN = 'Belo Horizonte',
    U5_OAB = '12345MG',
    U5_EST = 'MG',
    U5_CEP = '30123456',
    U5_CODPAIS = '55',
    U5_DDD = '31',
    U5_FONE = '3134567890',
    U5_CELULAR = '31987654321',
    U5_FAX = '3134567890',
    U5_FCOM1 = '3134567890',
    U5_FCOM2 = '3134567890',
    U5_EMAIL = 'lucas@example.com',
    U5_URL = 'http://www.lucas.com',
    U5_NIVEL = '1',
    U5_DNIVEL = 'Alta',
    U5_SEXO = 'M',
    U5_NIVER = '1990-01-01',
    U5_RENDA = 5000.00,
    U5_AUTORIZ = '1',
    U5_CIVIL = '2',
    U5_CONJUGE = 'Maria',
    U5_FILHOS = 2,
    U5_NOMEF = 'Pedro, Ana',
    U5_OPERADO = '001',
    U5_NOPERAD = 'Operador 1',
    U5_DIALIG = '1234567',
    U5_NDIALIG = 'Segunda a Sexta',
    U5_HORA1 = '08:00:00',
    U5_HORA2 = '17:00:00',
    U5_DIAVIS = '1234567',
    U5_NDIAVIS = 'Segunda a Sexta',
    U5_HORAV1 = '08:00:00',
    U5_HORAV2 = '17:00:00',
    U5_OBS = 'Cliente preferencial',
    U5_ATIVO = '1',
    U5_FUNCAO = '001',
    U5_DFUNCAO = 'Gerente',
    U5_GRUPO = '01',
    U5_DGRUPO = 'Administração',
    U5_DEPTO = '001',
    U5_DDEPTO = 'Recursos Humanos',
    U5_STATUS = '2',
    U5_CLIENTE = '000001',
    U5_LOJA = '01',
    U5_PROSPEC = '000001',
    U5_ULTCONT = '2024-06-01',
    U5_LOJAPRO = '01',
    U5_PERIOD = 30,
    U5_TIPO = '1',
    U5_IDSITE = '12345',
    U5_CODAGA = '123456',
    U5_AGBRES = '123456',
    U5_AGBCEL = '123456',
    U5_AGBFAX = '123456',
    U5_AGBCOM = '123456',
    U5_PAIS = 'BRA',
    U5_TRATA = 'Sr.',
    U5_TRATADE = 'Senhor',
    U5_IDEXC = 'EXC1234567890',
    U5_CHGKEY = 'CHG1234567890',
    U5_CODSA3 = '123456',
    U5_IDESTN = 'IDESTN12345',
    U5_NVESTN = 2,
    U5_CONPRI = '123456',
    U5_MSBLQL = '2',
    U5_CODUSR = '123456',
    U5_SOLICTE = '1',
    U5_ENDI = 'Rua Internacional, 456',
    U5_PRIEMP = '1',
    U5_COMENT = 'Cliente VIP',
    U5_PAPNEG = '2'
WHERE 
    Nome_da_Coluna_Correta = 'LUCAS';
Substitua Nome_da_Coluna_Correta pelo nome real da coluna correspondente. Se a coluna U5_CONTAT não existe, procure por um nome similar que seja relevante ao seu caso.




n deu certo tem como fazer noraml campo por campo ?? update na tabela su5990 

2/2

ChatGPT
Claro, vamos fazer as atualizações campo por campo na tabela SU5990. Segue abaixo um exemplo de script para atualizar cada campo individualmente, assumindo que U5_CONTAT agora é NOME:

sql
Copiar código
-- Atualizando U5_FILIAL
UPDATE SU5990
SET U5_FILIAL = '01'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CODCONT
UPDATE SU5990
SET U5_CODCONT = '123456'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CPF
UPDATE SU5990
SET U5_CPF = '12345678901234'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_END
UPDATE SU5990
SET U5_END = 'Rua Exemplo, 123'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_RG
UPDATE SU5990
SET U5_RG = 'MG1234567'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_BAIRRO
UPDATE SU5990
SET U5_BAIRRO = 'Centro'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_MUN
UPDATE SU5990
SET U5_MUN = 'Belo Horizonte'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_OAB
UPDATE SU5990
SET U5_OAB = '12345MG'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_EST
UPDATE SU5990
SET U5_EST = 'MG'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CEP
UPDATE SU5990
SET U5_CEP = '30123456'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CODPAIS
UPDATE SU5990
SET U5_CODPAIS = '55'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_DDD
UPDATE SU5990
SET U5_DDD = '31'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_FONE
UPDATE SU5990
SET U5_FONE = '3134567890'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CELULAR
UPDATE SU5990
SET U5_CELULAR = '31987654321'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_FAX
UPDATE SU5990
SET U5_FAX = '3134567890'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_FCOM1
UPDATE SU5990
SET U5_FCOM1 = '3134567890'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_FCOM2
UPDATE SU5990
SET U5_FCOM2 = '3134567890'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_EMAIL
UPDATE SU5990
SET U5_EMAIL = 'lucas@example.com'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_URL
UPDATE SU5990
SET U5_URL = 'http://www.lucas.com'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_NIVEL
UPDATE SU5990
SET U5_NIVEL = '1'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_DNIVEL
UPDATE SU5990
SET U5_DNIVEL = 'Alta'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_SEXO
UPDATE SU5990
SET U5_SEXO = 'M'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_NIVER
UPDATE SU5990
SET U5_NIVER = '1990-01-01'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_RENDA
UPDATE SU5990
SET U5_RENDA = 5000.00
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_AUTORIZ
UPDATE SU5990
SET U5_AUTORIZ = '1'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CIVIL
UPDATE SU5990
SET U5_CIVIL = '2'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_CONJUGE
UPDATE SU5990
SET U5_CONJUGE = 'Maria'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_FILHOS
UPDATE SU5990
SET U5_FILHOS = 2
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_NOMEF
UPDATE SU5990
SET U5_NOMEF = 'Pedro, Ana'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_OPERADO
UPDATE SU5990
SET U5_OPERADO = '001'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_NOPERAD
UPDATE SU5990
SET U5_NOPERAD = 'Operador 1'
WHERE U5_CONTAT = 'LUCAS';

-- Atualizando U5_DIALIG
UPDATE SU5990
SET U5_DIALIG = '1234567'
WHERE NOME = 'LUCAS';

-- Atualizando U5_NDIALIG
UPDATE SU5990
SET U5_NDIALIG = 'Segunda a Sexta'
WHERE NOME = 'LUCAS';

-- Atualizando U5_HORA1
UPDATE SU5990
SET U5_HORA1 = '08:00:00'
WHERE NOME = 'LUCAS';

-- Atualizando U5_HORA2
UPDATE SU5990
SET U5_HORA2 = '17:00:00'
WHERE NOME = 'LUCAS';

-- Atualizando U5_DIAVIS
UPDATE SU5990
SET U5_DIAVIS = '1234567'
WHERE NOME = 'LUCAS';



