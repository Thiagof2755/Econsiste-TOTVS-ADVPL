SELECT SZ9990.Z9_CODVEN, SF2990.F2_VALBRUT
FROM SZ9990
INNER JOIN SF2990 ON (SZ9990.Z9_CODVEN = SF2990.F2_VEND1 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND2 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND3 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND4 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND5 )
WHERE  SZ9990.Z9_CODVEN = '000001'
AND (F2_EMISSAO BETWEEN '20240101' AND '20241230')



		
SELECT SUM(SF2990.F2_VALBRUT) AS TOTAL_VALBRUT
FROM SZ9990
INNER JOIN SF2990 ON (SZ9990.Z9_CODVEN = SF2990.F2_VEND1 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND2 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND3 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND4 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND5 )
WHERE SZ9990.Z9_CODVEN = '000001'
AND (F2_EMISSAO BETWEEN '20240101' AND '20241230');



SELECT 
    TOTAL_VALBRUT,
    Z8_PERC,
	Z8_CODVEN

FROM (
    SELECT 
        SUM(SF2990.F2_VALBRUT) AS TOTAL_VALBRUT,
        SZ8990.Z8_PERC,
        SZ8990.Z8_CINI,
        SZ8990.Z8_CFIM,
		SZ8990.Z8_CODVEN

    FROM SZ9990
    INNER JOIN SF2990 ON (SZ9990.Z9_CODVEN = SF2990.F2_VEND1 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND2 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND3 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND4 OR SZ9990.Z9_CODVEN = SF2990.F2_VEND5 )
    INNER JOIN SZ8990 ON SZ9990.Z9_CODVEN = SZ8990.Z8_CODVEN
    WHERE SZ9990.Z9_CODVEN = '000001'
    AND (F2_EMISSAO BETWEEN '20240101' AND '20241230')
    GROUP BY SZ8990.Z8_PERC, SZ8990.Z8_CINI, SZ8990.Z8_CFIM, Z8_CODVEN
) AS Subquery
WHERE TOTAL_VALBRUT BETWEEN Z8_CINI AND Z8_CFIM;
